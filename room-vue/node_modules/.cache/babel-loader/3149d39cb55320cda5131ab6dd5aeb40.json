{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utils/request\";\nexport default {\n  data() {\n    return {\n      submitForm: {\n        type: 0,\n        title: '',\n        content: '',\n        roomId: null\n      },\n      submitFormRules: {\n        type: [{\n          required: true,\n          message: '请选择类型',\n          trigger: 'change'\n        }],\n        title: [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }],\n        content: [{\n          required: true,\n          message: '请输入内容',\n          trigger: 'blur'\n        }]\n      },\n      submitting: false,\n      roomList: []\n    };\n  },\n\n  methods: {\n    handleSubmit() {\n      this.$refs.submitForm.validate(valid => {\n        if (valid) {\n          this.submitting = true;\n          request.post('/feedback/add', {\n            studentId: JSON.parse(localStorage.getItem(\"user\")).id,\n            type: this.submitForm.type,\n            title: this.submitForm.title,\n            content: this.submitForm.content,\n            roomId: this.submitForm.roomId\n          }).then(resp => {\n            if (resp.code === 200) {\n              this.$message.success('提交成功');\n              this.resetSubmitForm(); // 1.5秒后跳转到我的反馈页面\n\n              setTimeout(() => {\n                this.$router.push('/feedbackList');\n              }, 1500);\n            } else {\n              this.$message.error(resp.message || '提交失败');\n            }\n\n            this.submitting = false;\n          }).catch(err => {\n            console.error('提交反馈错误:', err);\n            this.$message.error('提交失败，请稍后重试');\n            this.submitting = false;\n          });\n        }\n      });\n    },\n\n    resetSubmitForm() {\n      this.$refs.submitForm.resetFields();\n    },\n\n    viewMyFeedback() {\n      this.$router.push('/feedbackList');\n    },\n\n    getRoomList() {\n      request.get('/studyRooms/list').then(resp => {\n        if (resp.code === 200) {\n          this.roomList = resp.data;\n        }\n      });\n    }\n\n  },\n\n  created() {\n    this.getRoomList();\n  }\n\n};","map":{"version":3,"mappings":";AAsCA;AAEA;EACAA;IACA;MACAC;QACAC,OADA;QAEAC,SAFA;QAGAC,WAHA;QAIAC;MAJA,CADA;MAOAC;QACAJ;UAAAK;UAAAC;UAAAC;QAAA,EADA;QAEAN;UAAAI;UAAAC;UAAAC;QAAA,EAFA;QAGAL;UAAAG;UAAAC;UAAAC;QAAA;MAHA,CAPA;MAYAC,iBAZA;MAaAC;IAbA;EAeA,CAjBA;;EAkBAC;IACAC;MACA;QACA;UACA;UACAC;YACAC,sDADA;YAEAb,0BAFA;YAGAC,4BAHA;YAIAC,gCAJA;YAKAC;UALA,GAMAW,IANA,CAMAC;YACA;cACA;cACA,uBAFA,CAGA;;cACAC;gBACA;cACA,CAFA,EAEA,IAFA;YAGA,CAPA,MAOA;cACA;YACA;;YACA;UACA,CAlBA,EAkBAC,KAlBA,CAkBAC;YACAC;YACA;YACA;UACA,CAtBA;QAuBA;MACA,CA3BA;IA4BA,CA9BA;;IA+BAC;MACA;IACA,CAjCA;;IAkCAC;MACA;IACA,CApCA;;IAqCAC;MACAV;QACA;UACA;QACA;MACA,CAJA;IAKA;;EA3CA,CAlBA;;EA+DAW;IACA;EACA;;AAjEA","names":["data","submitForm","type","title","content","roomId","submitFormRules","required","message","trigger","submitting","roomList","methods","handleSubmit","request","studentId","then","resp","setTimeout","catch","err","console","resetSubmitForm","viewMyFeedback","getRoomList","created"],"sourceRoot":"src/views/student","sources":["feedback.vue"],"sourcesContent":["<!--学生提交投诉与评价-->\r\n<template>\r\n  <div class=\"container\">\r\n    <el-card class=\"submit-card\">\r\n      <div slot=\"header\">\r\n        <span style=\"font-size: 18px; font-weight: bold;\">提交投诉/评价</span>\r\n      </div>\r\n      <el-form :model=\"submitForm\" :rules=\"submitFormRules\" ref=\"submitForm\" label-width=\"100px\" style=\"max-width: 600px;\">\r\n        <el-form-item label=\"类型\" prop=\"type\">\r\n          <el-radio-group v-model=\"submitForm.type\">\r\n            <el-radio :label=\"0\">投诉</el-radio>\r\n            <el-radio :label=\"1\">评价</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"标题\" prop=\"title\">\r\n          <el-input v-model=\"submitForm.title\" placeholder=\"请输入标题\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"关联自习室\">\r\n          <el-select v-model=\"submitForm.roomId\" placeholder=\"请选择自习室（可选）\" style=\"width: 100%;\" clearable>\r\n            <el-option v-for=\"item in roomList\" :key=\"item.id\" :label=\"item.roomNumber + ' - ' + item.location\"\r\n                       :value=\"item.id\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"内容\" prop=\"content\">\r\n          <el-input type=\"textarea\" v-model=\"submitForm.content\" placeholder=\"请详细描述您的问题或建议\"\r\n                    :rows=\"8\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSubmit\" :loading=\"submitting\">提交</el-button>\r\n          <el-button @click=\"resetSubmitForm\">重置</el-button>\r\n          <el-button @click=\"viewMyFeedback\">查看我的反馈</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      submitForm: {\r\n        type: 0,\r\n        title: '',\r\n        content: '',\r\n        roomId: null\r\n      },\r\n      submitFormRules: {\r\n        type: [{required: true, message: '请选择类型', trigger: 'change'}],\r\n        title: [{required: true, message: '请输入标题', trigger: 'blur'}],\r\n        content: [{required: true, message: '请输入内容', trigger: 'blur'}]\r\n      },\r\n      submitting: false,\r\n      roomList: []\r\n    };\r\n  },\r\n  methods: {\r\n    handleSubmit() {\r\n      this.$refs.submitForm.validate(valid => {\r\n        if (valid) {\r\n          this.submitting = true;\r\n          request.post('/feedback/add', {\r\n            studentId: JSON.parse(localStorage.getItem(\"user\")).id,\r\n            type: this.submitForm.type,\r\n            title: this.submitForm.title,\r\n            content: this.submitForm.content,\r\n            roomId: this.submitForm.roomId\r\n          }).then(resp => {\r\n            if (resp.code === 200) {\r\n              this.$message.success('提交成功');\r\n              this.resetSubmitForm();\r\n              // 1.5秒后跳转到我的反馈页面\r\n              setTimeout(() => {\r\n                this.$router.push('/feedbackList');\r\n              }, 1500);\r\n            } else {\r\n              this.$message.error(resp.message || '提交失败');\r\n            }\r\n            this.submitting = false;\r\n          }).catch(err => {\r\n            console.error('提交反馈错误:', err);\r\n            this.$message.error('提交失败，请稍后重试');\r\n            this.submitting = false;\r\n          });\r\n        }\r\n      });\r\n    },\r\n    resetSubmitForm() {\r\n      this.$refs.submitForm.resetFields();\r\n    },\r\n    viewMyFeedback() {\r\n      this.$router.push('/feedbackList');\r\n    },\r\n    getRoomList() {\r\n      request.get('/studyRooms/list').then(resp => {\r\n        if (resp.code === 200) {\r\n          this.roomList = resp.data;\r\n        }\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.getRoomList();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  padding: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.submit-card {\r\n  width: 100%;\r\n  max-width: 800px;\r\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}