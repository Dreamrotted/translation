{"ast":null,"code":"import request from \"@/utils/request\";\nexport default {\n  data() {\n    return {\n      dataList: [],\n      current: 1,\n      pageSize: 10,\n      totalPage: 0,\n      dataListLoading: false,\n      query: {\n        studentNumber: '',\n        studentName: '',\n        roomNumber: '',\n        seatNumber: '',\n        status: '',\n        dateRange: null\n      }\n    };\n  },\n\n  methods: {\n    getDataList() {\n      this.dataListLoading = true;\n      const params = {\n        pageNum: this.current,\n        pageSize: this.pageSize\n      }; // 添加查询条件\n\n      if (this.query.studentNumber) {\n        params.studentNumber = this.query.studentNumber;\n      }\n\n      if (this.query.studentName) {\n        params.studentName = this.query.studentName;\n      }\n\n      if (this.query.roomNumber) {\n        params.roomNumber = this.query.roomNumber;\n      }\n\n      if (this.query.seatNumber) {\n        params.seatNumber = this.query.seatNumber;\n      }\n\n      if (this.query.status) {\n        params.status = this.query.status;\n      }\n\n      if (this.query.dateRange && this.query.dateRange.length === 2) {\n        params.startDate = this.query.dateRange[0];\n        params.endDate = this.query.dateRange[1];\n      }\n\n      request.get('/reservation/page', {\n        params\n      }).then(resp => {\n        if (resp.code === 200) {\n          this.dataList = resp.data.list;\n          this.totalPage = resp.data.total;\n        } else {\n          this.dataList = [];\n          this.$message.error(resp.message || '获取数据失败');\n        }\n\n        this.dataListLoading = false;\n      }).catch(err => {\n        console.error('获取预约数据错误:', err);\n        this.dataList = [];\n        this.dataListLoading = false;\n        this.$message.error('获取数据失败，请稍后重试');\n      });\n    },\n\n    resetSearch() {\n      this.query = {\n        studentNumber: '',\n        studentName: '',\n        roomNumber: '',\n        seatNumber: '',\n        status: '',\n        dateRange: null\n      };\n      this.current = 1;\n      this.getDataList();\n    },\n\n    sizeChangeHandle(val) {\n      this.pageSize = val;\n      this.current = 1;\n      this.getDataList();\n    },\n\n    currentChangeHandle(val) {\n      this.current = val;\n      this.getDataList();\n    }\n\n  },\n\n  created() {\n    this.getDataList();\n  }\n\n};","map":{"version":3,"mappings":"AAwGA;AAEA;EACAA;IACA;MACAC,YADA;MAEAC,UAFA;MAGAC,YAHA;MAIAC,YAJA;MAKAC,sBALA;MAMAC;QACAC,iBADA;QAEAC,eAFA;QAGAC,cAHA;QAIAC,cAJA;QAKAC,UALA;QAMAC;MANA;IANA;EAeA,CAjBA;;EAkBAC;IACAC;MACA;MACA;QACAC,qBADA;QAEAZ;MAFA,EAFA,CAOA;;MACA;QACAa;MACA;;MACA;QACAA;MACA;;MACA;QACAA;MACA;;MACA;QACAA;MACA;;MACA;QACAA;MACA;;MACA;QACAA;QACAA;MACA;;MAEAC;QAAAD;MAAA;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;UACA;QACA;;QACA;MACA,CATA,EASAE,KATA,CASAC;QACAC;QACA;QACA;QACA;MACA,CAdA;IAeA,CA5CA;;IA6CAC;MACA;QACAd,iBADA;QAEAC,eAFA;QAGAC,cAHA;QAIAC,cAJA;QAKAC,UALA;QAMAC;MANA;MAQA;MACA;IACA,CAxDA;;IAyDAU;MACA;MACA;MACA;IACA,CA7DA;;IA8DAC;MACA;MACA;IACA;;EAjEA,CAlBA;;EAqFAC;IACA;EACA;;AAvFA","names":["data","dataList","current","pageSize","totalPage","dataListLoading","query","studentNumber","studentName","roomNumber","seatNumber","status","dateRange","methods","getDataList","pageNum","params","request","catch","err","console","resetSearch","sizeChangeHandle","currentChangeHandle","created"],"sourceRoot":"src/views/admin","sources":["reservation.vue"],"sourcesContent":["<!--管理员预约数据查看-->\r\n<template>\r\n  <div class=\"container\">\r\n    <!--条件查询-->\r\n    <div class=\"search-bar\">\r\n      <el-input v-model=\"query.studentNumber\" placeholder=\"学号\" style=\"width: 150px;\"\r\n                @keyup.enter.native=\"getDataList\"></el-input>\r\n      <el-input v-model=\"query.studentName\" placeholder=\"姓名\" style=\"width: 150px; margin-left: 10px;\"\r\n                @keyup.enter.native=\"getDataList\"></el-input>\r\n      <el-input v-model=\"query.roomNumber\" placeholder=\"自习室编号\" style=\"width: 150px; margin-left: 10px;\"\r\n                @keyup.enter.native=\"getDataList\"></el-input>\r\n      <el-input v-model=\"query.seatNumber\" placeholder=\"座位编号\" style=\"width: 150px; margin-left: 10px;\"\r\n                @keyup.enter.native=\"getDataList\"></el-input>\r\n      <el-select v-model=\"query.status\" placeholder=\"预约状态\" style=\"width: 150px; margin-left: 10px;\" clearable>\r\n        <el-option label=\"已预约\" value=\"已预约\"></el-option>\r\n        <el-option label=\"已取消\" value=\"已取消\"></el-option>\r\n        <el-option label=\"已过期\" value=\"已过期\"></el-option>\r\n        <el-option label=\"已完成\" value=\"已完成\"></el-option>\r\n      </el-select>\r\n      <el-date-picker\r\n          v-model=\"query.dateRange\"\r\n          type=\"daterange\"\r\n          range-separator=\"至\"\r\n          start-placeholder=\"开始日期\"\r\n          end-placeholder=\"结束日期\"\r\n          value-format=\"yyyy-MM-dd\"\r\n          style=\"width: 240px; margin-left: 10px;\">\r\n      </el-date-picker>\r\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"getDataList\" style=\"margin-left: 10px\">搜索</el-button>\r\n      <el-button icon=\"el-icon-refresh\" @click=\"resetSearch\" style=\"margin-left: 10px\">重置</el-button>\r\n    </div>\r\n\r\n    <el-table :data=\"dataList\"\r\n              border\r\n              stripe\r\n              v-loading=\"dataListLoading\"\r\n              highlight-current-row\r\n              align-content: center>\r\n      <el-table-column type=\"index\" min-width=\"80\" header-align=\"center\" align=\"center\" label=\"序号\"></el-table-column>\r\n      <el-table-column prop=\"student.studentName\" header-align=\"center\" align=\"center\" min-width=\"100\" label=\"姓名\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"student.studentNumber\" header-align=\"center\" align=\"center\" min-width=\"100\" label=\"学号\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"student.majorName\" header-align=\"center\" align=\"center\" min-width=\"120\" label=\"专业\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"studyRooms.roomNumber\" header-align=\"center\" align=\"center\" min-width=\"120\" label=\"自习室编号\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"studyRooms.location\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"自习室位置\">\r\n      </el-table-column>\r\n      <el-table-column header-align=\"center\" align=\"center\" min-width=\"120\" label=\"座位编号\">\r\n        <template v-slot=\"scope\">\r\n          <el-tag type=\"primary\" v-if=\"scope.row.seat\">\r\n            {{ scope.row.seat.seatNumber }}\r\n          </el-tag>\r\n          <span v-else style=\"color: #999;\">--</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column header-align=\"center\" align=\"center\" min-width=\"100\" label=\"座位类型\">\r\n        <template v-slot=\"scope\">\r\n          <el-tag size=\"small\" type=\"info\" v-if=\"scope.row.seat\">\r\n            {{ scope.row.seat.seatType }}\r\n          </el-tag>\r\n          <span v-else style=\"color: #999;\">--</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column header-align=\"center\" align=\"center\" min-width=\"120\" label=\"签到时间\">\r\n        <template v-slot=\"scope\">\r\n          {{ scope.row.checkInTime || '--' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column header-align=\"center\" align=\"center\" min-width=\"120\" label=\"签退时间\">\r\n        <template v-slot=\"scope\">\r\n          {{ scope.row.checkOutTime || '--' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"startTime\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"开始时间\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"endTime\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"结束时间\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"status\" header-align=\"center\" align=\"center\" min-width=\"100\" label=\"状态\">\r\n        <template v-slot=\"scope\">\r\n          <el-tag v-if=\"scope.row.status === '已预约'\" type=\"success\">已预约</el-tag>\r\n          <el-tag v-else-if=\"scope.row.status === '已取消'\" type=\"info\">已取消</el-tag>\r\n          <el-tag v-else-if=\"scope.row.status === '已过期'\" type=\"warning\">已过期</el-tag>\r\n          <el-tag v-else-if=\"scope.row.status === '已完成'\" type=\"primary\">已完成</el-tag>\r\n          <el-tag v-else type=\"info\">{{ scope.row.status }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-pagination\r\n        @size-change=\"sizeChangeHandle\"\r\n        @current-change=\"currentChangeHandle\"\r\n        :current-page=\"current\"\r\n        :page-sizes=\"[10, 20, 50, 100]\"\r\n        :page-size=\"pageSize\"\r\n        :total=\"totalPage\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport request from \"@/utils/request\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      dataList: [],\r\n      current: 1,\r\n      pageSize: 10,\r\n      totalPage: 0,\r\n      dataListLoading: false,\r\n      query: {\r\n        studentNumber: '',\r\n        studentName: '',\r\n        roomNumber: '',\r\n        seatNumber: '',\r\n        status: '',\r\n        dateRange: null\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    getDataList() {\r\n      this.dataListLoading = true;\r\n      const params = {\r\n        pageNum: this.current,\r\n        pageSize: this.pageSize,\r\n      };\r\n\r\n      // 添加查询条件\r\n      if (this.query.studentNumber) {\r\n        params.studentNumber = this.query.studentNumber;\r\n      }\r\n      if (this.query.studentName) {\r\n        params.studentName = this.query.studentName;\r\n      }\r\n      if (this.query.roomNumber) {\r\n        params.roomNumber = this.query.roomNumber;\r\n      }\r\n      if (this.query.seatNumber) {\r\n        params.seatNumber = this.query.seatNumber;\r\n      }\r\n      if (this.query.status) {\r\n        params.status = this.query.status;\r\n      }\r\n      if (this.query.dateRange && this.query.dateRange.length === 2) {\r\n        params.startDate = this.query.dateRange[0];\r\n        params.endDate = this.query.dateRange[1];\r\n      }\r\n\r\n      request.get('/reservation/page', { params }).then((resp) => {\r\n        if (resp.code === 200) {\r\n          this.dataList = resp.data.list;\r\n          this.totalPage = resp.data.total;\r\n        } else {\r\n          this.dataList = [];\r\n          this.$message.error(resp.message || '获取数据失败');\r\n        }\r\n        this.dataListLoading = false;\r\n      }).catch(err => {\r\n        console.error('获取预约数据错误:', err);\r\n        this.dataList = [];\r\n        this.dataListLoading = false;\r\n        this.$message.error('获取数据失败，请稍后重试');\r\n      });\r\n    },\r\n    resetSearch() {\r\n      this.query = {\r\n        studentNumber: '',\r\n        studentName: '',\r\n        roomNumber: '',\r\n        seatNumber: '',\r\n        status: '',\r\n        dateRange: null\r\n      };\r\n      this.current = 1;\r\n      this.getDataList();\r\n    },\r\n    sizeChangeHandle(val) {\r\n      this.pageSize = val;\r\n      this.current = 1;\r\n      this.getDataList();\r\n    },\r\n    currentChangeHandle(val) {\r\n      this.current = val;\r\n      this.getDataList();\r\n    },\r\n  },\r\n  created() {\r\n    this.getDataList();\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  padding: 20px;\r\n}\r\n\r\n.search-bar {\r\n  margin-bottom: 20px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}