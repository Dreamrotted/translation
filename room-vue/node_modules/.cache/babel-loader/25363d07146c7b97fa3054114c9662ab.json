{"ast":null,"code":"import request from \"@/utils/request\";\nexport default {\n  data() {\n    return {\n      dataList: [],\n      // 表格数据\n      current: 1,\n      // 当前页码\n      pageSize: 10,\n      // 每页条数\n      totalPage: 0,\n      // 总条数\n      dataListLoading: false,\n      // 加载状态\n      dialogVisible: false,\n      // 弹窗显示状态\n      dialogTitle: '',\n      // 弹窗标题\n      form: {\n        id: null,\n        roomNumber: '',\n        capacity: '',\n        location: '',\n        status: '',\n        openingTime: '',\n        closingTime: ''\n      },\n      rules: {\n        roomNumber: [{\n          required: true,\n          message: '请输入自习室编号',\n          trigger: 'blur'\n        }],\n        capacity: [{\n          required: true,\n          message: '请输入可容纳人数',\n          trigger: 'blur'\n        }],\n        location: [{\n          required: true,\n          message: '请输入位置',\n          trigger: 'blur'\n        }],\n        openingTime: [{\n          required: true,\n          message: '请选择开放时间',\n          trigger: 'change'\n        }],\n        closingTime: [{\n          required: true,\n          message: '请选择关闭时间',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    // 获取表格数据\n    getDataList() {\n      this.dataListLoading = true;\n      request.get('studyRooms/page', {\n        params: {\n          pageNum: this.current,\n          pageSize: this.pageSize\n        }\n      }).then(resp => {\n        if (resp.code === 200) {\n          this.dataList = resp.data.list;\n          this.totalPage = resp.data.total;\n        } else {\n          this.dataList = [];\n        }\n\n        this.dataListLoading = false;\n      });\n    },\n\n    // 删除数据\n    del(id) {\n      this.$confirm('此操作将永久删除该数据, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        request.delete(\"/studyRooms/delete/\" + id).then(res => {\n          if (res.code === 200) {\n            this.$notify.success('删除成功');\n            this.getDataList();\n          } else {\n            this.$notify.error(res.message);\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    // 修改状态\n    check(id, status) {\n      const data = {\n        id: id,\n        status: status\n      };\n      request.put('/studyRooms/update', data).then(res => {\n        if (res.code === 200) {\n          this.$notify.success('修改成功');\n          this.getDataList();\n        } else {\n          this.$notify.error(res.message);\n        }\n      });\n    },\n\n    // 分页大小变化\n    sizeChangeHandle(val) {\n      this.pageSize = val;\n      this.current = 1;\n      this.getDataList();\n    },\n\n    // 当前页码变化\n    currentChangeHandle(val) {\n      this.current = val;\n      this.getDataList();\n    },\n\n    // 新增按钮点击事件\n    handleAdd() {\n      this.dialogTitle = '新增自习室';\n      this.dialogVisible = true;\n      this.resetForm();\n    },\n\n    // 编辑按钮点击事件\n    handleEdit(row) {\n      this.dialogTitle = '编辑自习室';\n      this.dialogVisible = true;\n      this.form = { ...row\n      }; // 将当前行的数据赋值给表单\n    },\n\n    // 提交表单\n    submitForm() {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          if (this.form.id) {\n            // 编辑\n            request.put(\"/studyRooms/update\", this.form).then(res => {\n              if (res.code === 200) {\n                this.$notify.success('修改成功');\n                this.dialogVisible = false;\n                this.getDataList();\n              } else {\n                this.$notify.error(res.message);\n              }\n            });\n          } else {\n            // 新增\n            request.post(\"/studyRooms/add\", this.form).then(res => {\n              if (res.code === 200) {\n                this.$notify.success('新增成功');\n                this.dialogVisible = false;\n                this.getDataList();\n              } else {\n                this.$notify.error(res.message);\n              }\n            });\n          }\n        }\n      });\n    },\n\n    // 重置表单\n    resetForm() {\n      this.form = {\n        id: null,\n        roomNumber: '',\n        capacity: '',\n        location: '',\n        openingTime: '',\n        closingTime: ''\n      };\n    }\n\n  },\n\n  created() {\n    this.getDataList();\n  }\n\n};","map":{"version":3,"mappings":"AA4GA;AAEA;EACAA;IACA;MACAC,YADA;MACA;MACAC,UAFA;MAEA;MACAC,YAHA;MAGA;MACAC,YAJA;MAIA;MACAC,sBALA;MAKA;MAEAC,oBAPA;MAOA;MACAC,eARA;MAQA;MACAC;QACAC,QADA;QAEAC,cAFA;QAGAC,YAHA;QAIAC,YAJA;QAKAC,UALA;QAMAC,eANA;QAOAC;MAPA,CATA;MAkBAC;QACAN;UAAAO;UAAAC;UAAAC;QAAA,EADA;QAEAR;UAAAM;UAAAC;UAAAC;QAAA,EAFA;QAGAP;UAAAK;UAAAC;UAAAC;QAAA,EAHA;QAIAL;UAAAG;UAAAC;UAAAC;QAAA,EAJA;QAKAJ;UAAAE;UAAAC;UAAAC;QAAA;MALA;IAlBA;EA0BA,CA5BA;;EA6BAC;IACA;IACAC;MACA;MACAC;QACAC;UACAC,qBADA;UAEArB;QAFA;MADA,GAKAsB,IALA,CAKAC;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;;QACA;MACA,CAbA;IAcA,CAlBA;;IAmBA;IACAC;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAL,IAJA,CAIA;QACAH;UACA;YACA;YACA;UACA,CAHA,MAGA;YACA;UACA;QACA,CAPA;MAQA,CAbA,EAaAS,KAbA,CAaA;QACA;UACAD,YADA;UAEAZ;QAFA;MAIA,CAlBA;IAmBA,CAxCA;;IAyCA;IACAc;MACA;QACAvB,MADA;QAEAI;MAFA;MAIAS;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;MACA,CAPA;IAQA,CAvDA;;IAwDA;IACAW;MACA;MACA;MACA;IACA,CA7DA;;IA8DA;IACAC;MACA;MACA;IACA,CAlEA;;IAmEA;IACAC;MACA;MACA;MACA;IACA,CAxEA;;IAyEA;IACAC;MACA;MACA;MACA;MAAA,EAHA,CAGA;IACA,CA9EA;;IA+EA;IACAC;MACA;QACA;UACA;YACA;YACAf;cACA;gBACA;gBACA;gBACA;cACA,CAJA,MAIA;gBACA;cACA;YACA,CARA;UASA,CAXA,MAWA;YACA;YACAA;cACA;gBACA;gBACA;gBACA;cACA,CAJA,MAIA;gBACA;cACA;YACA,CARA;UASA;QACA;MACA,CA1BA;IA2BA,CA5GA;;IA6GA;IACAgB;MACA;QACA7B,QADA;QAEAC,cAFA;QAGAC,YAHA;QAIAC,YAJA;QAKAE,eALA;QAMAC;MANA;IAQA;;EAvHA,CA7BA;;EAsJAwB;IACA;EACA;;AAxJA","names":["data","dataList","current","pageSize","totalPage","dataListLoading","dialogVisible","dialogTitle","form","id","roomNumber","capacity","location","status","openingTime","closingTime","rules","required","message","trigger","methods","getDataList","request","params","pageNum","then","resp","del","confirmButtonText","cancelButtonText","type","catch","check","sizeChangeHandle","currentChangeHandle","handleAdd","handleEdit","submitForm","resetForm","created"],"sourceRoot":"src/views/admin","sources":["studyRoom.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"action-bar\">\r\n      <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"handleAdd\">新增</el-button>\r\n    </div>\r\n    <div class=\"table-container\">\r\n      <el-table\r\n          :data=\"dataList\"\r\n          border\r\n          stripe\r\n          v-loading=\"dataListLoading\"\r\n          highlight-current-row\r\n          align-content: center>\r\n        <el-table-column type=\"index\" min-width=\"100\" header-align=\"center\" align=\"center\"\r\n                         label=\"序号\"></el-table-column>\r\n        <el-table-column prop=\"roomNumber\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"自习室编号\">\r\n        </el-table-column>\r\n\r\n        <el-table-column prop=\"location\" header-align=\"center\" align=\"center\" min-width=\"180\" label=\"位置\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"capacity\" header-align=\"center\" align=\"center\" min-width=\"180\" label=\"可容纳人数\"\r\n                         heigh=\"200\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"reservedNumber\" header-align=\"center\" align=\"center\" min-width=\"180\"\r\n                         label=\"已预约人数\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"openingTime\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"开放时间\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.openingTime || '--' }} ~ {{ scope.row.closingTime || '--' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" header-align=\"center\" align=\"center\" min-width=\"150\" label=\"状态\">\r\n          <template v-slot=\"scope\">\r\n            {{ scope.row.status === 0 ? '使用中' : '不可使用' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" header-align=\"center\" align=\"center\" width=\"220\" label=\"操作\">\r\n          <template v-slot=\"scope\">\r\n            <el-button type=\"primary\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n            <el-button type=\"warning\" v-if=\"scope.row.status === 0\" @click=\"check(scope.row.id,1)\">禁用</el-button>\r\n            <el-button type=\"success\" v-if=\"scope.row.status === 1\" @click=\"check(scope.row.id,0)\">启用</el-button>\r\n            <el-button type=\"danger\" @click=\"del(scope.row.id)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n        @size-change=\"sizeChangeHandle\"\r\n        @current-change=\"currentChangeHandle\"\r\n        :current-page=\"current\"\r\n        :page-sizes=\"[10, 20, 50, 100]\"\r\n        :page-size=\"pageSize\"\r\n        :total=\"totalPage\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\">\r\n    </el-pagination>\r\n\r\n    <!-- 新增/编辑弹窗 -->\r\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\" width=\"30%\">\r\n      <el-form :model=\"form\" label-width=\"100px\" ref=\"form\" :rules=\"rules\">\r\n        <el-form-item label=\"自习室编号\" prop=\"roomNumber\">\r\n          <el-input v-model=\"form.roomNumber\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"可容纳人数\" prop=\"capacity\">\r\n          <el-input v-model=\"form.capacity\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"位置\" prop=\"location\">\r\n          <el-input v-model=\"form.location\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"开放时间\" prop=\"openingTime\">\r\n          <el-time-select\r\n              v-model=\"form.openingTime\"\r\n              :picker-options=\"{\r\n              start: '06:00',\r\n              step: '00:30',\r\n              end: '23:30'\r\n            }\"\r\n              placeholder=\"选择开放时间\">\r\n          </el-time-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"关闭时间\" prop=\"closingTime\">\r\n          <el-time-select\r\n              v-model=\"form.closingTime\"\r\n              :picker-options=\"{\r\n              start: '06:00',\r\n              step: '00:30',\r\n              end: '23:30',\r\n              minTime: form.openingTime\r\n            }\"\r\n              placeholder=\"选择关闭时间\">\r\n          </el-time-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"状态\" v-if=\"form.id === null\">\r\n          <el-select v-model=\"form.status\" placeholder=\"请选择状态\">\r\n            <el-option label=\"可用\" value=\"0\"></el-option>\r\n            <el-option label=\"禁用\" value=\"1\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport request from \"@/utils/request\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      dataList: [], // 表格数据\r\n      current: 1, // 当前页码\r\n      pageSize: 10, // 每页条数\r\n      totalPage: 0, // 总条数\r\n      dataListLoading: false, // 加载状态\r\n\r\n      dialogVisible: false, // 弹窗显示状态\r\n      dialogTitle: '', // 弹窗标题\r\n      form: {\r\n        id: null,\r\n        roomNumber: '',\r\n        capacity: '',\r\n        location: '',\r\n        status: '',\r\n        openingTime: '',\r\n        closingTime: ''\r\n      },\r\n      rules: {\r\n        roomNumber: [{required: true, message: '请输入自习室编号', trigger: 'blur'}],\r\n        capacity: [{required: true, message: '请输入可容纳人数', trigger: 'blur'}],\r\n        location: [{required: true, message: '请输入位置', trigger: 'blur'}],\r\n        openingTime: [{required: true, message: '请选择开放时间', trigger: 'change'}],\r\n        closingTime: [{required: true, message: '请选择关闭时间', trigger: 'change'}]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    // 获取表格数据\r\n    getDataList() {\r\n      this.dataListLoading = true;\r\n      request.get('studyRooms/page', {\r\n        params: {\r\n          pageNum: this.current,\r\n          pageSize: this.pageSize\r\n        }\r\n      }).then((resp) => {\r\n        if (resp.code === 200) {\r\n          this.dataList = resp.data.list;\r\n          this.totalPage = resp.data.total;\r\n        } else {\r\n          this.dataList = [];\r\n        }\r\n        this.dataListLoading = false;\r\n      });\r\n    },\r\n    // 删除数据\r\n    del(id) {\r\n      this.$confirm('此操作将永久删除该数据, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        request.delete(\"/studyRooms/delete/\" + id).then(res => {\r\n          if (res.code === 200) {\r\n            this.$notify.success('删除成功');\r\n            this.getDataList();\r\n          } else {\r\n            this.$notify.error(res.message);\r\n          }\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });\r\n      });\r\n    },\r\n    // 修改状态\r\n    check(id,status) {\r\n      const data = {\r\n        id: id,\r\n        status: status\r\n      };\r\n      request.put('/studyRooms/update', data).then(res => {\r\n        if (res.code === 200) {\r\n          this.$notify.success('修改成功');\r\n          this.getDataList();\r\n        } else {\r\n          this.$notify.error(res.message);\r\n        }\r\n      });\r\n    },\r\n    // 分页大小变化\r\n    sizeChangeHandle(val) {\r\n      this.pageSize = val;\r\n      this.current = 1;\r\n      this.getDataList();\r\n    },\r\n    // 当前页码变化\r\n    currentChangeHandle(val) {\r\n      this.current = val;\r\n      this.getDataList();\r\n    },\r\n    // 新增按钮点击事件\r\n    handleAdd() {\r\n      this.dialogTitle = '新增自习室';\r\n      this.dialogVisible = true;\r\n      this.resetForm();\r\n    },\r\n    // 编辑按钮点击事件\r\n    handleEdit(row) {\r\n      this.dialogTitle = '编辑自习室';\r\n      this.dialogVisible = true;\r\n      this.form = {...row}; // 将当前行的数据赋值给表单\r\n    },\r\n    // 提交表单\r\n    submitForm() {\r\n      this.$refs.form.validate(valid => {\r\n        if (valid) {\r\n          if (this.form.id) {\r\n            // 编辑\r\n            request.put(\"/studyRooms/update\", this.form).then(res => {\r\n              if (res.code === 200) {\r\n                this.$notify.success('修改成功');\r\n                this.dialogVisible = false;\r\n                this.getDataList();\r\n              } else {\r\n                this.$notify.error(res.message);\r\n              }\r\n            });\r\n          } else {\r\n            // 新增\r\n            request.post(\"/studyRooms/add\", this.form).then(res => {\r\n              if (res.code === 200) {\r\n                this.$notify.success('新增成功');\r\n                this.dialogVisible = false;\r\n                this.getDataList();\r\n              } else {\r\n                this.$notify.error(res.message);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    },\r\n    // 重置表单\r\n    resetForm() {\r\n      this.form = {\r\n        id: null,\r\n        roomNumber: '',\r\n        capacity: '',\r\n        location: '',\r\n        openingTime: '',\r\n        closingTime: ''\r\n      };\r\n    }\r\n  },\r\n  created() {\r\n    this.getDataList();\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.container {\r\n  padding: 20px;\r\n}\r\n\r\n.action-bar {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.table-container {\r\n  overflow-x: auto;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}