{"ast":null,"code":"import request from \"@/utils/request\";\nimport * as echarts from 'echarts';\nexport default {\n  data() {\n    return {\n      overview: {\n        totalSeats: 0,\n        occupiedSeats: 0,\n        usageRate: 0,\n        todayViolations: 0,\n        todayReservations: 0,\n        todayCompleted: 0\n      },\n      realTimeData: {\n        rooms: [],\n        updateTime: ''\n      },\n      comparisonDateRange: null,\n      selectedRoomId: null,\n      trendDate: null,\n      roomList: [],\n      roomComparisonChart: null,\n      hourlyTrendChart: null,\n      autoRefreshTimer: null\n    };\n  },\n\n  methods: {\n    // 获取实时概览数据\n    getOverview() {\n      request.get('/statistics/overview').then(resp => {\n        if (resp.code === 200) {\n          this.overview = resp.data;\n        }\n      });\n    },\n\n    // 获取各自习室实时人数\n    getRealTimeOccupancy() {\n      request.get('/statistics/realTimeOccupancy').then(resp => {\n        if (resp.code === 200) {\n          this.realTimeData = resp.data;\n        }\n      });\n    },\n\n    // 获取自习室使用率对比\n    getRoomUsageComparison() {\n      const params = {};\n\n      if (this.comparisonDateRange && this.comparisonDateRange.length === 2) {\n        params.startDate = this.comparisonDateRange[0];\n        params.endDate = this.comparisonDateRange[1];\n      }\n\n      request.get('/statistics/roomUsageComparison', {\n        params\n      }).then(resp => {\n        if (resp.code === 200) {\n          this.renderRoomComparisonChart(resp.data);\n        }\n      });\n    },\n\n    // 获取时段使用率趋势\n    getRoomHourlyTrend() {\n      if (!this.selectedRoomId) {\n        return;\n      }\n\n      const params = {\n        roomId: this.selectedRoomId\n      };\n\n      if (this.trendDate) {\n        params.date = this.trendDate;\n      }\n\n      request.get('/statistics/roomHourlyTrend', {\n        params\n      }).then(resp => {\n        if (resp.code === 200) {\n          this.renderHourlyTrendChart(resp.data);\n        }\n      });\n    },\n\n    // 渲染柱状图\n    renderRoomComparisonChart(data) {\n      if (!this.roomComparisonChart) {\n        this.roomComparisonChart = echarts.init(document.getElementById('roomComparisonChart'));\n      }\n\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'shadow'\n          },\n          formatter: '{b}<br/>使用率: {c}%'\n        },\n        xAxis: {\n          type: 'category',\n          data: data.roomNames,\n          axisLabel: {\n            rotate: 45,\n            interval: 0\n          }\n        },\n        yAxis: {\n          type: 'value',\n          name: '使用率(%)',\n          max: 100\n        },\n        series: [{\n          name: '使用率',\n          type: 'bar',\n          data: data.usageRates,\n          itemStyle: {\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: '#83bff6'\n            }, {\n              offset: 0.5,\n              color: '#188df0'\n            }, {\n              offset: 1,\n              color: '#188df0'\n            }])\n          },\n          label: {\n            show: true,\n            position: 'top',\n            formatter: '{c}%'\n          }\n        }]\n      };\n      this.roomComparisonChart.setOption(option);\n    },\n\n    // 渲染折线图\n    renderHourlyTrendChart(data) {\n      if (!this.hourlyTrendChart) {\n        this.hourlyTrendChart = echarts.init(document.getElementById('hourlyTrendChart'));\n      }\n\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          formatter: '{b}<br/>使用率: {c}%'\n        },\n        xAxis: {\n          type: 'category',\n          data: data.hours,\n          boundaryGap: false\n        },\n        yAxis: {\n          type: 'value',\n          name: '使用率(%)',\n          max: 100\n        },\n        series: [{\n          name: '使用率',\n          type: 'line',\n          data: data.usageRates,\n          smooth: true,\n          itemStyle: {\n            color: '#67C23A'\n          },\n          areaStyle: {\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: 'rgba(103, 194, 58, 0.3)'\n            }, {\n              offset: 1,\n              color: 'rgba(103, 194, 58, 0.1)'\n            }])\n          },\n          label: {\n            show: false\n          }\n        }]\n      };\n      this.hourlyTrendChart.setOption(option);\n    },\n\n    // 获取自习室列表\n    getRoomList() {\n      request.get('/studyRooms/list').then(resp => {\n        if (resp.code === 200) {\n          this.roomList = resp.data;\n\n          if (this.roomList.length > 0) {\n            this.selectedRoomId = this.roomList[0].id;\n            this.getRoomHourlyTrend();\n          }\n        }\n      });\n    },\n\n    // 进度条颜色\n    getProgressColor(rate) {\n      const r = parseFloat(rate);\n      if (r >= 80) return '#F56C6C';\n      if (r >= 60) return '#E6A23C';\n      if (r >= 40) return '#409EFF';\n      return '#67C23A';\n    },\n\n    // 刷新所有数据\n    refreshAllData() {\n      this.getOverview();\n      this.getRealTimeOccupancy();\n      this.getRoomUsageComparison();\n\n      if (this.selectedRoomId) {\n        this.getRoomHourlyTrend();\n      }\n    },\n\n    // 启动自动刷新\n    startAutoRefresh() {\n      // 每10秒刷新一次\n      this.autoRefreshTimer = setInterval(() => {\n        this.refreshAllData();\n      }, 10000);\n    },\n\n    // 停止自动刷新\n    stopAutoRefresh() {\n      if (this.autoRefreshTimer) {\n        clearInterval(this.autoRefreshTimer);\n        this.autoRefreshTimer = null;\n      }\n    }\n\n  },\n\n  mounted() {\n    // 初始化数据\n    this.getOverview();\n    this.getRealTimeOccupancy();\n    this.getRoomUsageComparison();\n    this.getRoomList(); // 启动自动刷新\n\n    this.startAutoRefresh(); // 窗口大小改变时重新渲染图表\n\n    window.addEventListener('resize', () => {\n      if (this.roomComparisonChart) {\n        this.roomComparisonChart.resize();\n      }\n\n      if (this.hourlyTrendChart) {\n        this.hourlyTrendChart.resize();\n      }\n    });\n  },\n\n  beforeDestroy() {\n    // 停止自动刷新\n    this.stopAutoRefresh(); // 销毁图表实例\n\n    if (this.roomComparisonChart) {\n      this.roomComparisonChart.dispose();\n    }\n\n    if (this.hourlyTrendChart) {\n      this.hourlyTrendChart.dispose();\n    } // 移除窗口大小监听\n\n\n    window.removeEventListener('resize', () => {});\n  }\n\n};","map":{"version":3,"mappings":"AAkIA;AACA;AAEA;EACAA;IACA;MACAC;QACAC,aADA;QAEAC,gBAFA;QAGAC,YAHA;QAIAC,kBAJA;QAKAC,oBALA;QAMAC;MANA,CADA;MASAC;QACAC,SADA;QAEAC;MAFA,CATA;MAaAC,yBAbA;MAcAC,oBAdA;MAeAC,eAfA;MAgBAC,YAhBA;MAiBAC,yBAjBA;MAkBAC,sBAlBA;MAmBAC;IAnBA;EAqBA,CAvBA;;EAwBAC;IACA;IACAC;MACAC;QACA;UACA;QACA;MACA,CAJA;IAKA,CARA;;IAUA;IACAC;MACAD;QACA;UACA;QACA;MACA,CAJA;IAKA,CAjBA;;IAmBA;IACAE;MACA;;MACA;QACAC;QACAA;MACA;;MAEAH;QAAAG;MAAA;QACA;UACA;QACA;MACA,CAJA;IAKA,CAhCA;;IAkCA;IACAC;MACA;QACA;MACA;;MAEA;QAAAC;MAAA;;MACA;QACAF;MACA;;MAEAH;QAAAG;MAAA;QACA;UACA;QACA;MACA,CAJA;IAKA,CAlDA;;IAoDA;IACAG;MACA;QACA;MACA;;MAEA;QACAC;UACAC,eADA;UAEAC;YACAC;UADA,CAFA;UAKAC;QALA,CADA;QAQAC;UACAF,gBADA;UAEA9B,oBAFA;UAGAiC;YACAC,UADA;YAEAC;UAFA;QAHA,CARA;QAgBAC;UACAN,aADA;UAEAO,cAFA;UAGAC;QAHA,CAhBA;QAqBAC;UACAF,WADA;UAEAP,WAFA;UAGA9B,qBAHA;UAIAwC;YACAC,uDACA;cAAAC;cAAAD;YAAA,CADA,EAEA;cAAAC;cAAAD;YAAA,CAFA,EAGA;cAAAC;cAAAD;YAAA,CAHA;UADA,CAJA;UAWAE;YACAC,UADA;YAEAC,eAFA;YAGAd;UAHA;QAXA;MArBA;MAwCA;IACA,CAnGA;;IAqGA;IACAe;MACA;QACA;MACA;;MAEA;QACAnB;UACAC,eADA;UAEAG;QAFA,CADA;QAKAC;UACAF,gBADA;UAEA9B,gBAFA;UAGA+C;QAHA,CALA;QAUAX;UACAN,aADA;UAEAO,cAFA;UAGAC;QAHA,CAVA;QAeAC;UACAF,WADA;UAEAP,YAFA;UAGA9B,qBAHA;UAIAgD,YAJA;UAKAR;YACAC;UADA,CALA;UAQAQ;YACAR,uDACA;cAAAC;cAAAD;YAAA,CADA,EAEA;cAAAC;cAAAD;YAAA,CAFA;UADA,CARA;UAcAE;YACAC;UADA;QAdA;MAfA;MAmCA;IACA,CA/IA;;IAiJA;IACAM;MACA9B;QACA;UACA;;UACA;YACA;YACA;UACA;QACA;MACA,CARA;IASA,CA5JA;;IA8JA;IACA+B;MACA;MACA;MACA;MACA;MACA;IACA,CArKA;;IAuKA;IACAC;MACA;MACA;MACA;;MACA;QACA;MACA;IACA,CA/KA;;IAiLA;IACAC;MACA;MACA;QACA;MACA,CAFA,EAEA,KAFA;IAGA,CAvLA;;IAyLA;IACAC;MACA;QACAC;QACA;MACA;IACA;;EA/LA,CAxBA;;EAyNAC;IACA;IACA;IACA;IACA;IACA,mBALA,CAOA;;IACA,wBARA,CAUA;;IACAC;MACA;QACA;MACA;;MACA;QACA;MACA;IACA,CAPA;EAQA,CA5OA;;EA6OAC;IACA;IACA,uBAFA,CAIA;;IACA;MACA;IACA;;IACA;MACA;IACA,CAVA,CAYA;;;IACAD;EACA;;AA3PA","names":["data","overview","totalSeats","occupiedSeats","usageRate","todayViolations","todayReservations","todayCompleted","realTimeData","rooms","updateTime","comparisonDateRange","selectedRoomId","trendDate","roomList","roomComparisonChart","hourlyTrendChart","autoRefreshTimer","methods","getOverview","request","getRealTimeOccupancy","getRoomUsageComparison","params","getRoomHourlyTrend","roomId","renderRoomComparisonChart","tooltip","trigger","axisPointer","type","formatter","xAxis","axisLabel","rotate","interval","yAxis","name","max","series","itemStyle","color","offset","label","show","position","renderHourlyTrendChart","boundaryGap","smooth","areaStyle","getRoomList","getProgressColor","refreshAllData","startAutoRefresh","stopAutoRefresh","clearInterval","mounted","window","beforeDestroy"],"sourceRoot":"src/views/admin","sources":["dashboard.vue"],"sourcesContent":["<!--管理员数据分析与可视化-->\r\n<template>\r\n  <div class=\"dashboard-container\">\r\n    <!-- 实时概览数据卡片 -->\r\n    <el-row :gutter=\"20\" class=\"overview-cards\">\r\n      <el-col :xs=\"12\" :sm=\"6\">\r\n        <el-card class=\"data-card\">\r\n          <div class=\"card-content\">\r\n            <i class=\"el-icon-s-home card-icon\" style=\"color: #409EFF;\"></i>\r\n            <div class=\"card-info\">\r\n              <div class=\"card-value\">{{ overview.totalSeats }}</div>\r\n              <div class=\"card-label\">总座位数</div>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"12\" :sm=\"6\">\r\n        <el-card class=\"data-card\">\r\n          <div class=\"card-content\">\r\n            <i class=\"el-icon-user card-icon\" style=\"color: #67C23A;\"></i>\r\n            <div class=\"card-info\">\r\n              <div class=\"card-value\">{{ overview.occupiedSeats }}</div>\r\n              <div class=\"card-label\">使用中座位</div>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"12\" :sm=\"6\">\r\n        <el-card class=\"data-card\">\r\n          <div class=\"card-content\">\r\n            <i class=\"el-icon-pie-chart card-icon\" style=\"color: #E6A23C;\"></i>\r\n            <div class=\"card-info\">\r\n              <div class=\"card-value\">{{ overview.usageRate }}%</div>\r\n              <div class=\"card-label\">总使用率</div>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"12\" :sm=\"6\">\r\n        <el-card class=\"data-card\">\r\n          <div class=\"card-content\">\r\n            <i class=\"el-icon-warning card-icon\" style=\"color: #F56C6C;\"></i>\r\n            <div class=\"card-info\">\r\n              <div class=\"card-value\">{{ overview.todayViolations }}</div>\r\n              <div class=\"card-label\">今日违规次数</div>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 各自习室实时人数 -->\r\n    <el-card class=\"chart-card\">\r\n      <div slot=\"header\" class=\"card-header\">\r\n        <span>各自习室实时人数</span>\r\n        <span class=\"update-time\">更新时间: {{ realTimeData.updateTime }}</span>\r\n      </div>\r\n      <el-table :data=\"realTimeData.rooms\" stripe border max-height=\"300\">\r\n        <el-table-column prop=\"roomNumber\" label=\"自习室编号\" align=\"center\" width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"location\" label=\"位置\" align=\"center\" min-width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"totalSeats\" label=\"总座位数\" align=\"center\" width=\"100\"></el-table-column>\r\n        <el-table-column prop=\"occupiedSeats\" label=\"使用中\" align=\"center\" width=\"100\">\r\n          <template v-slot=\"scope\">\r\n            <el-tag type=\"success\">{{ scope.row.occupiedSeats }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"availableSeats\" label=\"可用\" align=\"center\" width=\"100\">\r\n          <template v-slot=\"scope\">\r\n            <el-tag type=\"info\">{{ scope.row.availableSeats }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"usageRate\" label=\"使用率\" align=\"center\" width=\"120\">\r\n          <template v-slot=\"scope\">\r\n            <el-progress :percentage=\"parseFloat(scope.row.usageRate)\" :color=\"getProgressColor(scope.row.usageRate)\"></el-progress>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 图表区域 -->\r\n    <el-row :gutter=\"20\" class=\"charts-row\">\r\n      <!-- 自习室使用率对比（柱状图） -->\r\n      <el-col :xs=\"24\" :lg=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <div slot=\"header\" class=\"card-header\">\r\n            <span>自习室使用率对比</span>\r\n            <div class=\"date-picker-wrapper\">\r\n              <el-date-picker\r\n                  v-model=\"comparisonDateRange\"\r\n                  type=\"daterange\"\r\n                  range-separator=\"至\"\r\n                  start-placeholder=\"开始日期\"\r\n                  end-placeholder=\"结束日期\"\r\n                  value-format=\"yyyy-MM-dd\"\r\n                  size=\"small\"\r\n                  @change=\"getRoomUsageComparison\">\r\n              </el-date-picker>\r\n            </div>\r\n          </div>\r\n          <div id=\"roomComparisonChart\" style=\"width: 100%; height: 400px;\"></div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <!-- 时段使用率趋势（折线图） -->\r\n      <el-col :xs=\"24\" :lg=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <div slot=\"header\" class=\"card-header\">\r\n            <span>时段使用率趋势</span>\r\n            <div class=\"controls-wrapper\">\r\n              <el-select v-model=\"selectedRoomId\" placeholder=\"选择自习室\" size=\"small\" @change=\"getRoomHourlyTrend\" style=\"width: 150px; margin-right: 10px;\">\r\n                <el-option v-for=\"room in roomList\" :key=\"room.id\" :label=\"room.roomNumber\" :value=\"room.id\"></el-option>\r\n              </el-select>\r\n              <el-date-picker\r\n                  v-model=\"trendDate\"\r\n                  type=\"date\"\r\n                  placeholder=\"选择日期\"\r\n                  value-format=\"yyyy-MM-dd\"\r\n                  size=\"small\"\r\n                  @change=\"getRoomHourlyTrend\">\r\n              </el-date-picker>\r\n            </div>\r\n          </div>\r\n          <div id=\"hourlyTrendChart\" style=\"width: 100%; height: 400px;\"></div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport * as echarts from 'echarts';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      overview: {\r\n        totalSeats: 0,\r\n        occupiedSeats: 0,\r\n        usageRate: 0,\r\n        todayViolations: 0,\r\n        todayReservations: 0,\r\n        todayCompleted: 0\r\n      },\r\n      realTimeData: {\r\n        rooms: [],\r\n        updateTime: ''\r\n      },\r\n      comparisonDateRange: null,\r\n      selectedRoomId: null,\r\n      trendDate: null,\r\n      roomList: [],\r\n      roomComparisonChart: null,\r\n      hourlyTrendChart: null,\r\n      autoRefreshTimer: null\r\n    };\r\n  },\r\n  methods: {\r\n    // 获取实时概览数据\r\n    getOverview() {\r\n      request.get('/statistics/overview').then(resp => {\r\n        if (resp.code === 200) {\r\n          this.overview = resp.data;\r\n        }\r\n      });\r\n    },\r\n\r\n    // 获取各自习室实时人数\r\n    getRealTimeOccupancy() {\r\n      request.get('/statistics/realTimeOccupancy').then(resp => {\r\n        if (resp.code === 200) {\r\n          this.realTimeData = resp.data;\r\n        }\r\n      });\r\n    },\r\n\r\n    // 获取自习室使用率对比\r\n    getRoomUsageComparison() {\r\n      const params = {};\r\n      if (this.comparisonDateRange && this.comparisonDateRange.length === 2) {\r\n        params.startDate = this.comparisonDateRange[0];\r\n        params.endDate = this.comparisonDateRange[1];\r\n      }\r\n\r\n      request.get('/statistics/roomUsageComparison', {params}).then(resp => {\r\n        if (resp.code === 200) {\r\n          this.renderRoomComparisonChart(resp.data);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 获取时段使用率趋势\r\n    getRoomHourlyTrend() {\r\n      if (!this.selectedRoomId) {\r\n        return;\r\n      }\r\n\r\n      const params = {roomId: this.selectedRoomId};\r\n      if (this.trendDate) {\r\n        params.date = this.trendDate;\r\n      }\r\n\r\n      request.get('/statistics/roomHourlyTrend', {params}).then(resp => {\r\n        if (resp.code === 200) {\r\n          this.renderHourlyTrendChart(resp.data);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 渲染柱状图\r\n    renderRoomComparisonChart(data) {\r\n      if (!this.roomComparisonChart) {\r\n        this.roomComparisonChart = echarts.init(document.getElementById('roomComparisonChart'));\r\n      }\r\n\r\n      const option = {\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'shadow'\r\n          },\r\n          formatter: '{b}<br/>使用率: {c}%'\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          data: data.roomNames,\r\n          axisLabel: {\r\n            rotate: 45,\r\n            interval: 0\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: 'value',\r\n          name: '使用率(%)',\r\n          max: 100\r\n        },\r\n        series: [{\r\n          name: '使用率',\r\n          type: 'bar',\r\n          data: data.usageRates,\r\n          itemStyle: {\r\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n              {offset: 0, color: '#83bff6'},\r\n              {offset: 0.5, color: '#188df0'},\r\n              {offset: 1, color: '#188df0'}\r\n            ])\r\n          },\r\n          label: {\r\n            show: true,\r\n            position: 'top',\r\n            formatter: '{c}%'\r\n          }\r\n        }]\r\n      };\r\n\r\n      this.roomComparisonChart.setOption(option);\r\n    },\r\n\r\n    // 渲染折线图\r\n    renderHourlyTrendChart(data) {\r\n      if (!this.hourlyTrendChart) {\r\n        this.hourlyTrendChart = echarts.init(document.getElementById('hourlyTrendChart'));\r\n      }\r\n\r\n      const option = {\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          formatter: '{b}<br/>使用率: {c}%'\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          data: data.hours,\r\n          boundaryGap: false\r\n        },\r\n        yAxis: {\r\n          type: 'value',\r\n          name: '使用率(%)',\r\n          max: 100\r\n        },\r\n        series: [{\r\n          name: '使用率',\r\n          type: 'line',\r\n          data: data.usageRates,\r\n          smooth: true,\r\n          itemStyle: {\r\n            color: '#67C23A'\r\n          },\r\n          areaStyle: {\r\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n              {offset: 0, color: 'rgba(103, 194, 58, 0.3)'},\r\n              {offset: 1, color: 'rgba(103, 194, 58, 0.1)'}\r\n            ])\r\n          },\r\n          label: {\r\n            show: false\r\n          }\r\n        }]\r\n      };\r\n\r\n      this.hourlyTrendChart.setOption(option);\r\n    },\r\n\r\n    // 获取自习室列表\r\n    getRoomList() {\r\n      request.get('/studyRooms/list').then(resp => {\r\n        if (resp.code === 200) {\r\n          this.roomList = resp.data;\r\n          if (this.roomList.length > 0) {\r\n            this.selectedRoomId = this.roomList[0].id;\r\n            this.getRoomHourlyTrend();\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    // 进度条颜色\r\n    getProgressColor(rate) {\r\n      const r = parseFloat(rate);\r\n      if (r >= 80) return '#F56C6C';\r\n      if (r >= 60) return '#E6A23C';\r\n      if (r >= 40) return '#409EFF';\r\n      return '#67C23A';\r\n    },\r\n\r\n    // 刷新所有数据\r\n    refreshAllData() {\r\n      this.getOverview();\r\n      this.getRealTimeOccupancy();\r\n      this.getRoomUsageComparison();\r\n      if (this.selectedRoomId) {\r\n        this.getRoomHourlyTrend();\r\n      }\r\n    },\r\n\r\n    // 启动自动刷新\r\n    startAutoRefresh() {\r\n      // 每10秒刷新一次\r\n      this.autoRefreshTimer = setInterval(() => {\r\n        this.refreshAllData();\r\n      }, 10000);\r\n    },\r\n\r\n    // 停止自动刷新\r\n    stopAutoRefresh() {\r\n      if (this.autoRefreshTimer) {\r\n        clearInterval(this.autoRefreshTimer);\r\n        this.autoRefreshTimer = null;\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    // 初始化数据\r\n    this.getOverview();\r\n    this.getRealTimeOccupancy();\r\n    this.getRoomUsageComparison();\r\n    this.getRoomList();\r\n\r\n    // 启动自动刷新\r\n    this.startAutoRefresh();\r\n\r\n    // 窗口大小改变时重新渲染图表\r\n    window.addEventListener('resize', () => {\r\n      if (this.roomComparisonChart) {\r\n        this.roomComparisonChart.resize();\r\n      }\r\n      if (this.hourlyTrendChart) {\r\n        this.hourlyTrendChart.resize();\r\n      }\r\n    });\r\n  },\r\n  beforeDestroy() {\r\n    // 停止自动刷新\r\n    this.stopAutoRefresh();\r\n\r\n    // 销毁图表实例\r\n    if (this.roomComparisonChart) {\r\n      this.roomComparisonChart.dispose();\r\n    }\r\n    if (this.hourlyTrendChart) {\r\n      this.hourlyTrendChart.dispose();\r\n    }\r\n\r\n    // 移除窗口大小监听\r\n    window.removeEventListener('resize', () => {});\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.dashboard-container {\r\n  padding: 20px;\r\n  background-color: #f0f2f5;\r\n}\r\n\r\n.overview-cards {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.data-card {\r\n  margin-bottom: 20px;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.data-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n}\r\n\r\n.card-content {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px 0;\r\n}\r\n\r\n.card-icon {\r\n  font-size: 48px;\r\n  margin-right: 20px;\r\n}\r\n\r\n.card-info {\r\n  flex: 1;\r\n}\r\n\r\n.card-value {\r\n  font-size: 32px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  line-height: 1;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.card-label {\r\n  font-size: 14px;\r\n  color: #909399;\r\n}\r\n\r\n.chart-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-weight: bold;\r\n}\r\n\r\n.update-time {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  font-weight: normal;\r\n}\r\n\r\n.date-picker-wrapper, .controls-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.charts-row {\r\n  margin-top: 20px;\r\n}\r\n\r\n/* 响应式布局 */\r\n@media (max-width: 768px) {\r\n  .card-icon {\r\n    font-size: 36px;\r\n    margin-right: 10px;\r\n  }\r\n\r\n  .card-value {\r\n    font-size: 24px;\r\n  }\r\n\r\n  .card-label {\r\n    font-size: 12px;\r\n  }\r\n\r\n  .card-header {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n  }\r\n\r\n  .date-picker-wrapper, .controls-wrapper {\r\n    margin-top: 10px;\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}