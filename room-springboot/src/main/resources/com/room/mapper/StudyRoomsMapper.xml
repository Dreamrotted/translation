<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.room.mapper.StudyRoomsMapper">

    <update id="update">
        update study_rooms
        <set>
            <if test="roomNumber != null">
                room_number = #{roomNumber},
            </if>
            <if test="capacity != null">
                capacity = #{capacity},
            </if>
            <if test="location != null">
                location = #{location},
            </if>
            <if test="status != null">
                `status` = #{status},
            </if>
            <if test="openingTime != null">
                opening_time = #{openingTime},
            </if>
            <if test="closingTime != null">
                closing_time = #{closingTime},
            </if>
        </set>
        where id = #{id}
    </update>
    <select id="getResidualCapacity" resultType="java.lang.Integer">
        select count(*) from reservations where room_id = #{roomId} and start_time between #{startTime} and #{endTime}
    </select>
</mapper>
